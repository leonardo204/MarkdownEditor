# 요구사항 문서

## 소개

이 문서는 macOS용 네이티브 Markdown 에디터 애플리케이션의 요구사항을 정의합니다. 이 애플리케이션은 SwiftUI와 Swift로 작성되며, GitHub Flavored Markdown을 지원하는 분할 화면 에디터입니다. 왼쪽에 소스 편집기, 오른쪽에 실시간 미리보기를 제공하며, 파일 Drag & Drop 기능과 Mermaid 다이어그램 렌더링을 지원합니다.

## 요구사항

### 요구사항 1: 기본 에디터 인터페이스

**사용자 스토리:** 사용자로서, 분할 화면으로 Markdown을 편집하고 실시간으로 미리보기를 확인하고 싶습니다. 이를 통해 작성 중인 문서의 최종 결과물을 즉시 확인할 수 있습니다.

#### 수락 기준

1. 애플리케이션이 시작되면 시스템은 왼쪽에 소스 편집기, 오른쪽에 미리보기 패널이 있는 분할 화면을 표시해야 합니다 (SHALL).
2. 사용자가 소스 편집기에 텍스트를 입력하면 시스템은 미리보기 패널에 렌더링된 결과를 표시해야 합니다 (SHALL).
3. "Automatically reload preview" 옵션이 활성화되어 있으면 시스템은 편집 시 자동으로 미리보기를 갱신해야 합니다 (SHALL).
4. 소스 편집기는 라인 번호를 표시해야 합니다 (SHALL).
5. 소스 편집기는 Markdown 구문 강조(syntax highlighting)를 지원해야 합니다 (SHALL).

### 요구사항 2: 테마 및 스타일링

**사용자 스토리:** 사용자로서, 에디터와 미리보기의 테마를 선택하여 편안한 환경에서 작업하고 싶습니다.

#### 수락 기준

1. 시스템은 에디터 테마 선택 기능을 제공해야 합니다 (Dark/Light) (SHALL).
2. 시스템은 미리보기 테마 선택 기능을 제공해야 합니다 (Dark/Light) (SHALL).
3. 사용자가 테마를 변경하면 시스템은 즉시 해당 패널의 테마를 적용해야 합니다 (SHALL).

### 요구사항 3: Markdown 포맷팅 도구

**사용자 스토리:** 사용자로서, 툴바의 버튼을 클릭하여 쉽게 Markdown 서식을 적용하고 싶습니다.

#### 수락 기준

1. 시스템은 다음 서식 버튼을 툴바에 제공해야 합니다 (SHALL):
   - Bold, Italic, Strike Through
   - Quote, Code
   - Link
   - Bulleted List, Numbered List, Task List
   - Table
   - Heading 1-5
2. 사용자가 텍스트를 선택하고 서식 버튼을 클릭하면 시스템은 선택된 텍스트에 해당 Markdown 구문을 적용해야 합니다 (SHALL).
3. 텍스트가 선택되지 않은 상태에서 서식 버튼을 클릭하면 시스템은 커서 위치에 해당 Markdown 구문 템플릿을 삽입해야 합니다 (SHALL).

### 요구사항 4: 확장된 Markdown 지원

**사용자 스토리:** 사용자로서, 다양한 Markdown 문법을 사용하여 문서를 작성하고 미리보기에서 올바르게 렌더링된 결과를 확인하고 싶습니다.

#### 수락 기준

1. 시스템은 CommonMark 표준 요소를 미리보기에서 렌더링해야 합니다 (SHALL):
   - 헤더 (H1-H6)
   - 불릿 리스트 및 번호 리스트
   - 코드 블록 (구문 강조 포함)
   - 인라인 코드
   - 인용구 (Blockquote)
   - 링크 및 이미지
   - 강조 (Bold, Italic)
   - 수평선
2. 시스템은 GitHub Flavored Markdown 확장을 지원해야 합니다 (SHALL):
   - 테이블
   - 체크박스 리스트 (Task List)
   - 취소선 (Strikethrough)
   - 자동 링크 (Autolinks)
   - URL 자동 변환
3. 시스템은 추가 확장 문법을 지원해야 합니다 (SHALL):
   - 각주 (Footnotes): `[^1]` 형식
   - 수식 (Math): 인라인 `$...$` 및 블록 `$$...$$` (LaTeX 문법)
   - 정의 목록 (Definition Lists)
   - 하이라이트 (Highlight): `==텍스트==` 형식
   - 위 첨자/아래 첨자: `^위첨자^`, `~아래첨자~`

### 요구사항 5: 파일 Drag & Drop

**사용자 스토리:** 사용자로서, Markdown 파일을 에디터 창에 끌어다 놓아 파일을 열고 싶습니다. 이를 통해 빠르게 파일을 열 수 있습니다.

#### 수락 기준

1. 사용자가 Markdown 파일(.md, .markdown)을 애플리케이션 창에 드래그하면 시스템은 드롭 가능 영역을 시각적으로 표시해야 합니다 (SHALL).
2. 사용자가 파일을 드롭하면 시스템은 파일 내용을 읽어 소스 편집기에 표시해야 합니다 (SHALL).
3. 현재 편집 중인 문서에 저장되지 않은 변경사항이 있는 경우 시스템은 저장 여부를 확인하는 대화상자를 표시해야 합니다 (SHALL).
4. 시스템은 지원하지 않는 파일 형식이 드롭되면 적절한 오류 메시지를 표시해야 합니다 (SHALL).

### 요구사항 6: 다이어그램 지원 (Mermaid & PlantUML)

**사용자 스토리:** 사용자로서, Markdown 문서에 Mermaid 또는 PlantUML 문법으로 다이어그램을 작성하고 미리보기에서 렌더링된 다이어그램을 확인하고 싶습니다.

#### 수락 기준

1. 사용자가 Mermaid 코드 블록(```mermaid)을 작성하면 시스템은 미리보기에서 다이어그램으로 렌더링해야 합니다 (SHALL).
2. 시스템은 다음 Mermaid 다이어그램 유형을 지원해야 합니다 (SHALL):
   - Flowchart
   - Sequence Diagram
   - Class Diagram
   - State Diagram
   - Entity Relationship Diagram
   - Gantt Chart
3. 사용자가 PlantUML 코드 블록(```plantuml)을 작성하면 시스템은 미리보기에서 다이어그램으로 렌더링해야 합니다 (SHALL).
4. 시스템은 다음 PlantUML 다이어그램 유형을 지원해야 합니다 (SHALL):
   - Sequence Diagram
   - Use Case Diagram
   - Class Diagram
   - Activity Diagram
   - Component Diagram
   - State Diagram
5. 다이어그램 코드에 오류가 있으면 시스템은 미리보기에 오류 메시지를 표시해야 합니다 (SHALL).

### 요구사항 7: 성능 최적화

**사용자 스토리:** 사용자로서, 큰 문서를 편집하거나 다이어그램을 포함한 문서를 작업할 때도 에디터가 빠르고 반응성 있게 동작하기를 원합니다.

#### 수락 기준

1. 시스템은 사용자 입력에 대해 즉각적인 반응(16ms 이내)을 보장해야 합니다 (SHALL).
2. 시스템은 미리보기 갱신 시 debouncing(300ms)을 적용하여 불필요한 렌더링을 방지해야 합니다 (SHALL).
3. 시스템은 Markdown 처리를 백그라운드 스레드에서 수행해야 합니다 (SHALL).
4. 시스템은 다이어그램 렌더링 결과를 캐싱하여 동일한 다이어그램의 재렌더링을 방지해야 합니다 (SHALL).
5. 시스템은 화면에 보이는 영역만 우선적으로 렌더링해야 합니다 (SHALL).
6. 10,000줄 이상의 문서에서도 에디터가 원활하게 동작해야 합니다 (SHALL).

### 요구사항 8: 파일 관리

**사용자 스토리:** 사용자로서, 새 문서를 만들고, 기존 문서를 열고, 편집한 문서를 저장하고 싶습니다.

#### 수락 기준

1. 시스템은 새 문서 생성 기능을 제공해야 합니다 (File > New 또는 Cmd+N) (SHALL).
2. 시스템은 기존 파일 열기 기능을 제공해야 합니다 (File > Open 또는 Cmd+O) (SHALL).
3. 시스템은 현재 문서 저장 기능을 제공해야 합니다 (File > Save 또는 Cmd+S) (SHALL).
4. 시스템은 다른 이름으로 저장 기능을 제공해야 합니다 (File > Save As 또는 Cmd+Shift+S) (SHALL).
5. 문서에 저장되지 않은 변경사항이 있으면 시스템은 창 제목에 "Edited" 표시를 해야 합니다 (SHALL).
6. 저장되지 않은 변경사항이 있는 상태에서 애플리케이션을 종료하려 하면 시스템은 저장 여부를 확인해야 합니다 (SHALL).

### 요구사항 9: 내보내기 기능

**사용자 스토리:** 사용자로서, 작성한 Markdown 문서를 HTML 형식으로 내보내고 싶습니다.

#### 수락 기준

1. 시스템은 Export 버튼/메뉴를 통해 HTML 내보내기 기능을 제공해야 합니다 (SHALL).
2. 내보낸 HTML 파일은 미리보기에서 보이는 것과 동일한 스타일을 포함해야 합니다 (SHALL).
3. 사용자가 내보내기를 선택하면 시스템은 저장 위치와 파일명을 선택할 수 있는 대화상자를 표시해야 합니다 (SHALL).

### 요구사항 10: 미리보기 모드 전환

**사용자 스토리:** 사용자로서, 미리보기 패널에서 렌더링된 결과와 원본 HTML 코드를 전환하여 볼 수 있기를 원합니다.

#### 수락 기준

1. 시스템은 미리보기 패널에 "Preview"와 "HTML" 탭을 제공해야 합니다 (SHALL).
2. "Preview" 탭 선택 시 시스템은 렌더링된 Markdown을 표시해야 합니다 (SHALL).
3. "HTML" 탭 선택 시 시스템은 변환된 HTML 소스 코드를 표시해야 합니다 (SHALL).

### 요구사항 11: 애플리케이션 아이콘

**사용자 스토리:** 사용자로서, 애플리케이션을 쉽게 식별할 수 있는 고유한 아이콘을 원합니다.

#### 수락 기준

1. 애플리케이션은 제공된 icon.png 이미지를 앱 아이콘으로 사용해야 합니다 (SHALL).
2. 아이콘은 macOS 요구사항에 맞는 다양한 크기(16x16, 32x32, 128x128, 256x256, 512x512, 1024x1024)로 생성되어야 합니다 (SHALL).
3. 아이콘은 Dock, Finder, Spotlight 등 모든 macOS 시스템 영역에서 올바르게 표시되어야 합니다 (SHALL).

### 요구사항 12: DMG 배포 패키지

**사용자 스토리:** 사용자로서, DMG 파일을 다운로드하여 쉽게 애플리케이션을 설치하고 싶습니다.

#### 수락 기준

1. 빌드 시스템은 create-dmg 도구를 사용하여 DMG 설치 파일을 생성해야 합니다 (SHALL).
2. DMG 파일은 애플리케이션을 Applications 폴더로 드래그할 수 있는 설치 화면을 포함해야 합니다 (SHALL).
3. DMG 파일은 적절한 볼륨 이름과 아이콘을 가져야 합니다 (SHALL).

### 요구사항 13: Apple 코드 서명 및 공증

**사용자 스토리:** 사용자로서, macOS에서 보안 경고 없이 애플리케이션을 실행하고 싶습니다.

#### 수락 기준

1. 애플리케이션은 유효한 Apple Developer 인증서로 코드 서명되어야 합니다 (SHALL).
2. 애플리케이션은 Apple 공증(notarization)을 통과해야 합니다 (SHALL).
3. DMG 파일도 코드 서명 및 공증되어야 합니다 (SHALL).
4. 빌드 스크립트는 notarytool을 사용하여 자동으로 공증을 수행해야 합니다 (SHALL).
5. 공증에는 저장된 키체인 프로필 "notarytool"을 사용해야 합니다 (SHALL).
